
# Storage Fundamentals – From Disk to Filesystems (On‑Prem Deep Dive)

This document explains **storage from first principles**, exactly how it exists on real servers.
No cloud abstractions. No Kubernetes. No Docker.
Only **physical reality + operating system layers**.

---

## 1. Why Storage Exists

RAM is temporary.
When power goes off, RAM loses everything.

So computers need **persistent storage**.
The only thing computers can persist is **bytes written somewhere durable**.

That durable place is a **disk**.

---

## 2. Disk – The Absolute Foundation

A disk (HDD / SSD / NVMe) is:

- A device that stores **blocks**
- Each block is usually **4 KB**
- Blocks are addressed by numbers

```
Block 0
Block 1
Block 2
Block 3
...
Block N
```

Important truth:

> Disks do NOT understand files, folders, or names.
> They only read and write numbered blocks.

In Linux, disks appear as:

```
/dev/sda
/dev/sdb
```

These are **raw block devices**.

---

## 3. What Is a Block?

A **block** is:

- Fixed-size chunk of bytes
- Smallest unit the disk reads or writes

Disks only answer questions like:

> Read block 8123  
> Write block 9120

There is **no concept of a file** at this level.

---

## 4. Why Files Don’t Exist Naturally

Without structure, raw disk looks like:

```
010101010010101011010...
```

So the OS needs rules to say:

- Which blocks belong to which file
- What a filename means
- Where directories live

Those rules are called a **filesystem**.

---

## 5. Filesystem – Turning Blocks into Files

A filesystem is a **rulebook** written on disk that defines:

- Filenames
- Directories
- Permissions
- Metadata
- Mapping: file → blocks

Diagram:

```
[ Filesystem ]
     |
     v
Block 4001
Block 4002
Block 4003
```

Common on‑prem filesystems:

- ext4
- xfs
- NTFS (Windows)

Formatting a disk = writing filesystem rules onto disk.

---

## 6. Mounting – Making Files Visible

A filesystem exists on disk, but is not visible until mounted.

Mounting means:

> Attach a filesystem to a directory so files appear there.

Example:

```
mount /dev/sdb1 /data
```

After mounting:

```
/data  → shows files from /dev/sdb1
```

Before mounting, `/data` is just an empty directory.

---

## 7. Important Mount Rule (Critical)

If a directory already had files:

```
/data/old.txt
```

And you mount a filesystem on `/data`, then:

- `old.txt` is hidden
- NOT deleted
- Reappears after unmount

Mounting overlays the directory.

---

## 8. Local Block Storage (Direct Attached)

This is the simplest and fastest storage.

```
Disk → Filesystem → Mount → Application
```

Properties:

- Very fast
- Predictable
- Not shared
- If server dies → data inaccessible

Used for:

- OS disks
- Databases
- Logs

---

## 9. RAID – Protecting Against Disk Failure

RAID combines disks before filesystem.

```
Disk A + Disk B + Disk C
        ↓
     RAID device
        ↓
   Filesystem
```

RAID protects against **disk failure**, not deletion.

---

## 10. LVM – Flexible Block Management

LVM sits on top of disks/RAID.

```
Disks → RAID → LVM → Filesystem → Mount
```

Provides:

- Resize volumes
- Move data
- Snapshots

Still block storage.

---

## 11. Network Block Storage (SAN)

Disk lives on another machine but looks local.

```
Application
  ↓
Filesystem
  ↓
Block Device (/dev/sdX)
  ↓
Network
  ↓
SAN Storage
```

Protocols:

- iSCSI
- Fibre Channel

Databases work well here.

---

## 12. Network File Storage (NFS)

NFS shares **files**, not blocks.

```
Disk → Filesystem → NFS Server → Network → Client
```

Clients do file operations:
- open()
- read()
- write()

Properties:

- Easy sharing
- Slower
- Network dependent

Good for:
- Home directories
- Artifacts
- Backups

Bad for:
- Databases

---

## 13. Distributed Filesystems (On‑Prem)

Examples:
- CephFS
- GlusterFS

```
Multiple Servers
  ↓   ↓   ↓
Distributed FS
```

Provide:
- Replication
- Fault tolerance
- Scale

Tradeoff:
- Complexity
- Latency

---

## 14. Block vs File – Final Comparison

| Aspect | Block Storage | File Storage |
|-----|-----|-----|
| Access | Blocks | Files |
| Filesystem | You manage | Server manages |
| Speed | Fast | Slower |
| Sharing | Hard | Easy |
| DBs | Ideal | Risky |

---

## 15. Why Disks Are “Faster”

Not because magic.

Because:

- Fewer layers
- No network
- Predictable latency

Path length matters more than raw speed.

---

## 16. The Full On‑Prem Storage Stack

```
Physical Disk
   ↓
RAID (optional)
   ↓
LVM (optional)
   ↓
Filesystem
   ↓
Mount
   ↓
Application / NFS / Database
```

---

## 17. Final Truth

> All storage, no matter how advanced, eventually writes bytes to disk blocks.

If you understand this stack:
- You won’t lose data
- You’ll debug performance correctly
- Kubernetes storage will make sense later

---

End of document.
