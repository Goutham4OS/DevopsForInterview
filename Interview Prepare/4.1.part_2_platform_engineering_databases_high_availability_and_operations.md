# Part 2: Platform Engineering – Databases, High Availability & Operations

This document explains **how databases are run in production**, from a **Platform Engineer / DevOps Engineer perspective**.

---

## 1. Platform Engineer Role (Databases)

Your job is NOT:
- Writing SQL queries
- Designing schemas

Your job IS:
- Making databases reliable
- Making failures invisible
- Making recovery predictable

---

## 2. How Applications Connect to Databases

### Basic Flow

```
Application → Database Endpoint
```

In production:
- No public access
- Private networking only

---

### Authentication Methods

Preferred order:
1. Managed Identity (Cloud)
2. Service account / secret (Kubernetes)

Never:
- Hardcode passwords

---

## 3. High Availability (HA) Explained Slowly

### 3.1 Primary & Replica

```
App → Primary → Replica
```

- Primary handles writes
- Replica copies data

If primary fails:
- Replica becomes primary
- App reconnects

---

### 3.2 Active-Passive

- One active node
- One standby

Failover:
- Standby promoted

Simple and safe.

---

### 3.3 Active-Active

- Multiple nodes active
- Data synchronized

Used for:
- Caches
- Read-heavy systems

Trade-off:
- Eventual consistency

---

## 4. Redis High Availability (Detailed)

### Why Redis Needs HA

- Runs in memory
- Node crash = data loss

---

### Redis HA Model

- Primary handles writes
- Replicas handle reads

Failover:
- Replica promoted automatically

---

### Redis Scaling Reality

Important truth:
- HPA does NOT split Redis data

Scaling options:
- Add replicas
- Redis Cluster (sharding)

---

## 5. Redis on Kubernetes (Ops View)

### Node Selection

Why:
- Redis needs RAM

How:
- Dedicated memory node pool
- Node selectors
- Taints & tolerations

---

### Resource Management

You must set:
- Memory requests
- Memory limits

Without this:
- Pod eviction

---

## 6. Backups & Restore (Non-Negotiable)

Golden rule:
> Backup without restore test is useless

You must:
- Automate backups
- Test restores
- Define RTO / RPO

---

## 7. Security (Database & Redis)

Layers:
- Private network only
- TLS encryption
- Identity-based auth

---

## 8. What Breaks in Production

- Primary DB failure
- Replica lag
- Redis eviction
- Cache stampede

Your job:
- Detect fast
- Fail over cleanly
- Recover confidently

---

## 9. Final Platform Mindset

- Databases must be boring
- Failures are expected
- Recovery must be automated

---

You now understand **database operations & HA at platform level**.

